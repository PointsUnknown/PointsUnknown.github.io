<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-108699112-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-108699112-1');
  </script>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="../../favicon.ico">
  <title>Points Unknown</title>

  <!-- Bootstrap -->
  <link href="../css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom CSS -->
  <link href="../css/site-specific.css" rel="stylesheet">

  <!-- Google fonts -->
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:300,400,500|Roboto:300,300i,400,400i" rel="stylesheet">

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body data-spy="scroll" data-target="#myScrollspy" data-offset="10">
  <!-- Fixed navbar -->
  <nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">Points Unknown</a>
      </div>
      <div id="navbar" class="navbar-collapse collapse">
        <ul class="nav navbar-nav navbar-right">
          <!-- <li class="active"><a href="#">Home</a></li> -->
          <li><a href="../index.html">About</a></li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Courses <span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a href="../gsapp_spring2019.html">GSAPP - Spring 2019</a></li>
              <li><a href="../journalism_spring2019a.html">Journalism - Spring 2019 (A)</a></li>
              <li><a href="../journalism_spring2019b.html">Journalism - Spring 2019 (B)</a></li>
              <li><a href="../gsapp_spring2018.html">GSAPP - Spring 2018</a></li>
              <li><a href="../journalism_spring2018a.html">Journalism - Spring 2018 (A)</a></li>
              <li><a href="../journalism_spring2018b.html">Journalism - Spring 2018 (B)</a></li>
              <li><a href="../journalism_fall2017.html">Journalism - Fall 2017</a></li>
            </ul>
          </li>
          <li class="dropdown active">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Tutorials <span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><h4>QGIS 2</h4>
              <li><a href="00_InstallationInstructions.html">00 - Installation Instructions</a></li>
              <li><a href="01_BasicMap.html">01 - Basic Map</a></li>
              <li><a href="02_AnnotationLayer.html">02 - Annotation Layers</a></li>
              <li><a href="03_PointData.html">03 - Working with Point Data</a></li>
              <li><a href="04_CensusJoins.html">04 - Working with Census Data</a></li>
              <li><a href="05_ChangeMapping.html">05 - Change Mapping</a></li>
              <li><a href="06_Geocoding.html">06 - Geocoding</a></li>
              <li><h4>QGIS 3</h4>
              <li><a href="00_Q3_InstallationInstructions.html">00 - Installation Instructions (QGIS 3.x)</a></li>
              <li><a href="01_Q3_BasicMaps.html">01 - Basic Maps (QGIS 3.x)</a></li>
              <li><a href="02_Q3_JoinsCensus.html">02 - Joins and Census Data (QGIS 3.x)</a></li>
              <li><a href="03_Q3_Geocoding.html">03 - Geocoding and Joining Point Data (QGIS 3.x)</a></li>
              <li><a href="04_Q3_SpatialAnalysis.html">04 - Spatial Analysis (QGIS 3.x)</a></li>
              <li><h4>ARCGIS</h4>
              <li><a href="07_SpatialStatistics.html">07 - Spatial Statistics</a></li>
              <li><a href="08_MCDA.html">08 - Multi-Criteria Decision Analysis</a></li>
              <li><a href="09_NetworkAnalysis.html">09 - Network Analysis</a></li>
              <li><h4>Web Mapping</h4>
              <li><a href=""><em>Coming Soon</em></a></li>
            </ul>
          </li>
          <li><a href="../enroll.html">Enroll</a></li>
          <li><a href="../resources.html">Resources</a></li>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </nav>
  <div class="jumbotron">
    <div class="container">
      <h1>Tutorial 03 - Working With Point Data (Simplified)</h1>
      <p>Using 311 data from New York City, this tutorial will show you how to load point data into QGIS and create a quantitative map of this data. There are three basic steps in this process: first, select, filter and download 311 data; second, load the 311 data to a map in QGIS; and third, classify the data so that it is correctly displayed on the map. In addition, this tutorial will also describe how to join the 311 data to another spatial dataset (census block groups) in order to aggregate it and display it based on its geographical location.</p>
    </div>
  </div>
  <div class="container">
    <div class="row">
      <div class="col-md-9" role="main">
        <div class="section">
          <span class="anchor" id="datasets"></span>
          <h1 class="page-header">
            Datasets
          </h1>
          <p>To create this map we will be using the datasets below. A simple and complete download package of the data can be found at <a href="http://brwn.co/pd-simple">brwn.co/pd-simple</a>.</p>
          <ul>
            <li><p>Boroughs - New York City boroughs. Download from <a href="http://www1.nyc.gov/site/planning/data-maps/open-data/districts-download-metadata.page">NYC Planning - Open Data</a>. Choose "Borough Boundaries (Clipped to Shoreline)", under "Borough Boundaries &amp; Community Districts".</p></li>
            <li><p>Census Block Groups - New York State census block groups. Download from <a href="https://www.census.gov/cgi-bin/geo/shapefiles/index.php">U.S. Census Bureau - Tiger/Line Shapefiles</a>. Select <code>2016</code> and <code>Block Groups</code>, and click <code>Submit</code>. Then, select <code>New York</code> as the state and click <code>Download</code>.</p></li>
            <li><p>Hydrography - New York City hydrography. Download from <a href="https://data.cityofnewyork.us/Environment/Hydrography/drh3-e2fd">NYC OpenData</a>. Once you get to the NYC OpenData page, click <code>Export</code> and choose the <code>Shapefile</code> format.</p></li>
            <li><p>Hydrography U.S. - United States hydrography. Download from the <a href="https://www.rita.dot.gov/bts/sites/rita.dot.gov.bts/files/publications/national_transportation_atlas_database/2015/polygon">Bureau of Transportation Statistics</a>. When you get to the Bureau of Transportation Statistics page click on the Hydrographic Features <code>ZIP</code> file.</p></li>
            <li><p>States - U.S. State Boundaries. Download from the <a href="https://www.rita.dot.gov/bts/sites/rita.dot.gov.bts/files/publications/national_transportation_atlas_database/2015/polygon"> Bureau of Transportation Statistics</a>. When you get to the Bureau of Transportation Statistics page click on the U.S. State Boundaries <code>ZIP</code> file.</p></li>
          </ul>
        </div>
        <div class="section">
          <span class="anchor" id="about311data"></span>
          <h1 class="page-header">About 311 Data</h1>
          <p>The main dataset we will be using in this tutorial is based on 311 data. For those of you who don't know, 311 is a service provided by the city of New York where people can call in (dialing 311) and submit complaints or ask questions about living in the city (the service also accepts complaints online). Some of the most popular complaints filed through 311 are about parking, noise, garbage, rodents, dead or damaged trees, air quality, construction permits, graffiti, homelessness, street conditions, taxis and water quality. There are other categories and each one of these has it's own subcategories. Furthermore, each entry in the dataset comes with the following fields (amongst others):</p>
          <ul>
            <li><p>Created date</p></li>
            <li><p>Closed date</p></li>
            <li><p>Agency</p></li>
            <li><p>Complaint type</p></li>
            <li><p>Descriptor</p></li>
            <li><p>Location type</p></li>
            <li><p>Incident zip code</p></li>
            <li><p>Incident address</p></li>
            <li><p>Street name</p></li>
            <li><p>City</p></li>
            <li><p>Landmark</p></li>
            <li><p>Facility type</p></li>
            <li><p>Status</p></li>
            <li><p>Due date</p></li>
            <li><p>Resolution description</p></li>
            <li><p>Community board</p></li>
            <li><p>X and Y coordinates</p></li>
            <li><p>Latitude and longitude</p></li>
          </ul>
          <p>As you can see, the dataset is very interesting and a great resource for anyone studying New York. <b>Nevertheless, a word of caution is necessary</b>: many people use this dataset to describe and analyze conditions in New York; however, the 311 data doesn't describe the city, it describes the complaints people file, it is not about the city, it is about the complaints, and even though the complaints might tell us something about the city, the distinction is crucial. Every dataset has its own biases and the 311 dataset has very strong ones: it collects data ONLY about the people who complain and ONLY about what they choose to complain about. Again, this dataset is much more about the complaints and the people who complain than about the conditions in the city. There is no 1 to 1 relationship between the 311 complaints and the conditions in the ground. That being said, though, it is still a great resource and very fun to play with. You can find out more about the 311 service <a href="http://www1.nyc.gov/311/">here</a>.</p>
        </div>
        <div class="section">
          <span class="anchor" id="download311"></span>
          <h1 class="page-header">Accessing 311 Data</h1>
          <ul>
            <li><p>This tutorial includes filtered data, but for reference, here is how we got the data. The <a href="https://opendata.cityofnewyork.us/">NYC OpenData portal</a> is a great resource for data related to New York City and it provides an easy way of accessing 311 data. In it's search bar type <code>311</code> and it should take you to a list of datasets related to 311 data. The one we are looking for is called <code>311 Service Requests from 2010 to Present</code>. Once you click there , select <code>View Data</code> from the <code>Explore Data</code> dropdown menu.</p></li>
            <li><p>Once you've accessed the dataset you will see something like this:</p></li>
            <img class="img-responsive" src="tutorialImages/04_PointData/01_311_Dataset.png" alt="thumb">
            <li><p>Here, we need to filter the database to download only the complaints related to the sewer system for 2016. You could attempt to download records for a longer period of time, but the files might be too large. To filter the data do the following:</p></li>
            <ul>
              <li><p>On the right-hand panel, where it says "Filter", create a small query using the drop-down menus. Where it says <code>Unique Key</code>, change it to <code>Complaint Type</code>. Keep the <code>is</code> and then type in "Sewer" in the space below (The query should read "Complaint type is sewer". Make sure there is a check-mark next to the word "sewer". You will see how the dataset is filtered and you only get the complaints of type "Sewer".</p></li>
              <li><p>Next, click on <code>Add a New Filter Condition</code> and create another query that reads <code>Created Date</code> <code>is between</code> "01/1/2016 12:00:00 AM" and "1/1/2017 12:00:00 AM". You should now see the data only for "Sewer" complaints created in 2016.</p></li>
              <li><p>You should see something like this:</p></li>
            </ul>
            <img class="img-responsive" src="tutorialImages/04_PointData/02_311Filter.png" alt="thumb">
            <ul>
              <li><p>Finally, click on the <code>Export</code> button at the top right-hand corner of the site and choose the <code>CSV</code> (comma separated values) format. Your file should start downloading then.</p></li>
              <li><p>If you open your .csv file in Excel you will see that there are about 33,000 records and that they have both X and Y coordinates and Latitude and Longitude. In the next steps we will use these fields to add the 311 data to a QGIS map.</p></li>
            </ul>
          </ul>
        </div>
        <div class="section">
          <span class="anchor" id="addingLayers"></span>
          <h1 class="page-header">
            Adding Layers
          </h1>
          <p>The first step in creating a basic map is to open QGIS and add the layers you downloaded.</p>
          <ul>
            <li><p>To add shapefiles click on the <code>Add Vector Layer</code> button.
              Other types of data will be added using the other buttons,
              but in this tutorial we will only be using vector data (shapefiles). Other types of data
              include rasters, csv (comma separated values), and postGIS layers.</p></li>
            <img class="img-responsive" src="tutorialImages/01_BasicMap/01_Adding_Layers.png" alt="thumb">
            <li><p>Start by adding the Boroughs layer. The reason we start with this one is because
              we know it has the right projection for New York City
              (NAD_1983_StatePlane_New_York_Long_Island_FIPS_3104_Feet). Since map projects will
              automatically take the projection of the first layer we add, by loading this layer first
              we make sure we are working with the right one.</p>
          </li>
            <li><p>Make sure you select the files with the extension <code>.shp</code>. Remember that a shapefile is actually made up of 5 or 6 individual files with different extensions. Normally, these individual files are the following:</p>
            <ul>
              <li><p>.shp - The main file that stores the feature geometry (required).</p></li>
              <li><p>.shx - The index file that stores the index of the feature geometry (required).</p></li>
              <li><p>.dbf - The dBASE table that stores the attribute information of features (required).</p></li>
              <li><p>.sbn and .sbx - The files that store the spatial index of features (these might get corrupted, see note at the end of this tutorial).</p></li>
              <li><p>.prj - The file that stores the coordinate system information.</p></li>
              <li><p>For more information on these extensions and others see <a href="http://webhelp.esri.com/arcgisdesktop/9.2/index.cfm?TopicName=Shapefile_file_extensions">this explanation by ESRI</a>.</p></li>
            </ul>
            </li>
            <li><p>Once you've added all the layers you downloaded, you need to organize them in the layer panel. Remember that the layers will be drawn in the same order they appear in the panel: the top layer will be drawn last, on top of the other ones.</p></li>
            <li><p>The final order of the layers should be something like this (from top to bottom):</p>
              <ul>
                <li><p>Census Block Groups</p></li>
                <li><p>Boroughs</p></li>
                <li><p>Hydrography</p></li>
                <li><p>Hydrography U.S. (choose the <code>hydropol.shp</code> file.)</p></li>
                <li><p>States</p></li>
              </ul>
            </li>
            <li><p>These layers will probably come with different names but you can rename them by right-clicking on them in the Layers Panel and selecting
            <code>Rename</code>.</p></li>
            <li><p>If when you zoom in to one of the layers some of its features disappear see the <a href="#note">note</a> at the end of the tutorial.</p></li>
          </ul>
        </div>
        <div class="section">
          <span class="anchor" id="symbology"></span>
          <h1 class="page-header">Basic Symbology</h1>
          <p>Symbology is one of the most important concepts in mapping.
            At its most basic level, symbology stands for changing the color, line weight, size or outline of a layer.
            However, and more importantly, it also means changing the appearance of a layer <em>based on one or multiple of its attributes</em>.
           In this tutorial we will do both, simple color changes and more advanced symbologies based on attributes.
           <br><br>
           As you may have seen, QGIS assigns random colors to each of the layers you add. To change the appearance of each layer do the following:</p>
          <ul>
            <li><p>There are multiple ways of changing the appearance of a layer. The easiest
              (and simplest) is to double-click on the icon (point, line or polygon) next to the
              layer name on the layer panel. This brings up the <code>Style</code> tab in the
              <code>Layer Properties</code> panel. In there you can change the fill (color),
              stroke weight and fill (outline) and the size of the icon (if using points or icons).</p></li>
            <img class="img-responsive" src="tutorialImages/01_BasicMap/03_Style_Layer_Properties.png" alt="thumb">
            <li><p>In this panel change the style for the following layers in the following ways (we will leave the Census Block Groups for the end):</p>
            <ul>
              <li><p>Boroughs:
              <ul>
                <li><p>Fill style: No Brush</p></li>
                <li><p>Outline style: Solid Line</p></li>
                <li><p>Outline width: 0.25</p></li>
              </ul></p></li>
              <li><p>Hydrography:
              <ul>
                <li><p>Fill: #e6e6e6 (HTML notation)</p></li>
                <li><p>Outline style: No Pen</p></li>
              </ul></p></li>
              <li><p>Hydrography U.S.:
                <ul>
                  <li><p>Fill: #e6e6e6 (HTML notation)</p></li>
                  <li><p>Outline style: No Pen</p></li>
                </ul></p></li>
              <li><p>State:
              <ul>
                <li><p>Fill: #ffffff (HTML notation)</p></li>
                <li><p>Outline style: No Pen</p></li>
              </ul></p></li>
            </ul></li>
            <li><p>To change the appearance of the background, select the <code>Project</code> menu, and in there select <code>Project Properties</code>. Then, in the <code>General</code> tab you can change the <code>Background color</code> to #e6e6e6 (HTML notation).</p></li>
            <img class="img-responsive" src="tutorialImages/01_BasicMap/04_Project_Properties.png" alt="thumb">
          </ul>
        </div>
        <div class="section">
          <span class="anchor" id="addingData"></span>
          <h1 class="page-header">Adding Point Data to QGIS</h1>
          <ul>
            <li><p>First, open a new map in QGIS and add the following layers (links at the <a href="#datasets">beginning of this tutorial</a>). Remember to add the boroughs first so that the map takes on the right projection.</p></li>
            <ul>
              <li><p>Boroughs</p></li>
              <li><p>Hydrography</p></li>
              <li><p>Hydrography U.S.</p></li>
              <li><p>States</p></li>
            </ul>
            <li><p>Organize your layers so that you have the water for New York City on top, then boroughs, then the water for the U.S. and finally the states.</p></li>
            <li><p>Remember to create a definition query for the Hydrology U.S. layer to display only the water features (for a recap on how to do this see the <a href="01_BasicMap.html#query">Definition Queries</a> section of Tutorial 01).</p></li>
            <li><p>Now, to add the CSV file we downloaded, click on the <code>Add Delimited Text Layer</code> button on the top toolbar. If your icon isn't displaying, it is due to your version of QGIS. In this case, navigate to <code>Layer</code> > <code>Add Layer</code> > <code>Add Delimited Text Layer</code>.</p></li>
            <img class="img-responsive" src="tutorialImages/04_PointData/03_AddCSV.png" alt="thumb">
            <li><p>In the menu that comes up, look for your .csv (311 data) file. Once you've selected your file QGIS will automatically select some presets. You should have the following options selected:</p></li>
            <ul>
              <li><p>File format: <code>CSV (comma separated values)</code> - this is the format our data is in: each value is separated by a comma.</p></li>
              <li><p>Record options: <code>First record has field names</code> - the first row of our file contains the field names.</p></li>
              <li><p>Geometry definition: <code>Point coordinates</code> - our data has latitude and longitude data.</p></li>
              <li><p>X field: <code>Longitude</code> and Y field: <code>Latitude</code> - these are the columns in our dataset that contain our location coordinates</p></li>
              <li><p>Your menu should look something like this:</p></li>
            </ul>
            <img class="img-responsive" src="tutorialImages/04_PointData/04_ImportMenu.png" alt="thumb">
            <li><p>Once you click <code>OK</code> you might get a warning that says that x number of records were discarded because they didn't have geometry definitions. Click <code>Close</code>. There might be some records in the dataset that we downloaded that for some reason didn't include location data.</p></li>
            <li><p>Next, QGIS will ask you to select a coordinate reference system (map projection) for this layer. Since we are adding this data based on the latitude and longitude information (decimal degrees, as opposed to feet) we need to select the <code>WGS 84</code>, which is the coordinate system that will correctly interpret this data. You will find it under <code>Geographic Coordinate Systems</code>. You will find more information on this coordinate system <a href="https://en.wikipedia.org/wiki/World_Geodetic_System">here</a>. Once you select the correct coordinate system, your points will appear on the map. If you don't see your points, it might be because they were added underneath one of the other layers. Make sure the new points layers is on top of the other ones.</p></li>
            <li><p>Even though your points are already on the map, this is just a temporary layer. If you remove the layer, you will need to go through the whole importing process to add them again. To avoid this, we need to export the layer as a shapefile.</p></li>
            <ul>
              <li><p>Now you should have all the records that have latitude and longitude selected and we can proceed to export them as a shapefile.</p></li>
              <li><p>Close the attribute table, right-click on the 311 layer and select <code>Export</code> > <code>Save Feature As</code>.</p></li>
              <li><p>In the following menu choose:</p></li>
              <ul>
                <li><p>Format: <code>ESRI Shapefile</code> - this is the same format of our other layers.</p></li>
                <li><p>Save as: choose the appropriate location and name for your file.</p></li>
                <li><p>CRS: <code>EPSG:102718 - NAD_1983_StatePlane_New_York_Long_Island_FIPS_3104_Feet</code> - this is the coordinate system we are working with and we want this layer to have the same one.</p></li>
                <li><p>Uncheck <code>Skip attribute creation</code> - you still want to retain the attributes associated with each point.</p></li>
                <li><p>Check <code>Add saved file to map</code> - so that once you export the layer, the layer is added to your map.</p></li>
              </ul>
              <li><p>Once you export your layer (and it's automatically added to your map) you can remove the original one by right-clicking and choosing <code>Remove</code>.</p></li>
            </ul>
          </ul>
        </div>
        <div class="section">
          <span class="anchor" id="quantitative"></span>
          <h1 class="page-header">Creating a Quantitative Map of 311 Sewage Complaints</h1>
          <p>Finally, we will select a subset of the 311 data and join it to New York City's census block groups, creating a map that displays the number of complaints per block group. This is very useful if, for example, you want to identify what parts of the city receive the highest number of sewer backup complaints.<br><br>However, when performing statistical analysis with these kinds of maps you have should be aware of the <a href="https://en.wikipedia.org/wiki/Modifiable_areal_unit_problem">modifiable areal unit problem</a>: basically, the problem is that we are arbitrarily choosing to aggregate the complaints by census block groups, but we could also aggregate them by neighborhood or community district, which could very well yield different results. In addition, some block groups are larger than others, or more densely populated, and thus, probably generate more complaints. Therefore, a better version of this map would display <i>complaints per person</i> instead of just total number of complaints. However, for the sake of brevity we will just do complaints per block group.</p>
          <ul>
            <li><p>First, let's create a subset of the 311 data with only "Sewer Backup" complaints.</p></li>
            <ul>
              <li><p>Open the attribute table by right-clicking on the 311 data layer and selecting <code>Open Attribute Table</code>.</p></li>
              <li><p>In the attribute table go to the <code>Select features using and expression</code> window.</p></li>
              <li><p>There, write the expression <code>"Descriptor"  =  'Sewer Backup (Use Comments) (SA)'</code> to select only the complaints related to sewage backup. You should have around 12,277 complaints selected.</p></li>
              <li><p>Exit the attribute table</p>.</li>
              <li><p>Now, export those selected complaints as its own shapefile by right-clicking on the layer and choosing <code>Export</code> > <code>Save Feature As...</code>.</p></li>
              <li><p>Once you've exported the selected complaints and added them to your map, remove the layer with all the 311 complaints.</p></li>
            </ul>
            <li><p>Now we are ready to join the complaint data to the census block groups:</p></li>
            <ul>
              <li><p>To join point into the polygons that contain them click on <code>Vector</code>, <code>Analysis Tools</code>, <code>Count points in polygon...</code>.</p></li>
            </ul>
            <img class="img-responsive" src="tutorialImages/04_PointData/08_CountPoints.png" alt="thumb">
            <ul>
              <li><p>In the <code>Count points in polygon...</code> menu choose the following options:</p></li>
              <ul>
                <li><p>Polygons: Block group layer.</p></li>
                <li><p>Points: Complaints layer.</p></li>
                <li><p>Count field name: the default (NUMPOINTS) is fine.</p></li>
              </ul>
              <li><p>Click <code>Run</code>.</p></li>
              <li><p>After the operation runs, you should get a new layer called <code>Count</code>. To verify that everything worked open its attribute table and scroll to the last field, called <code>NUMPOINTS</code>. It should contain some zeros but it should also contain some other values. If it just contains zeros something went wrong, most probably you were using layers with different coordinate reference systems. If this happens, try verifying the coordinate reference systems in the <code>Properties</code> tab of the layers and if indeed they are different, try re-exporting one of them to make them match.</p></li>
              <li><p>Finally, once you have your new layer with the count, you have to export it as a new shapefile.</p></li>
            </ul>
            <li><p>The last step is to symbolize the values in this new layer and create the map:</p></li>
            <ul>
              <li><p>First, in order to just symbolize the block groups that have one or more complaints you should create a definition query to show only these ones:</p></li>
              <ul>
                <li><p>Right-click on the layer and in the <code>Properties</code> option go to the <code>Source</code> tab and under the <code>Provide Feature Filter</code> area, locate the <code>Query Builder</code> button and select it.</p></li>
                <li><p>Here, write the following expression: <code>"NUMPOINTS" > 0</code>. This will ensure that only the block groups with one or more complaints are visisble.</p></li>
              </ul>
            </ul>
            <img class="img-responsive" src="tutorialImages/04_PointData/09_DefinitionQuery.png" alt="thumb">
            <ul>
              <li><p>Now, to symbolize by quantity right-click on the layer and choose <code>Properties</code>.</p></li>
              <li><p>In the <code>Style</code> dropdown menu choose <code>Graduated</code>.</p></li>
              <li><p>In the <code>Column</code> dropdown menu choose the <code>NUMPOINTS</code> field to symbolize and click on the <code>Classify</code> button to load the values.</p></li>
              <li><p>You will notice that QGIS automatically classifies the values into 5 categories. Also, if you look at the <code>Mode</code> dropdown menu below the classification you will see that the software uses an <code>Equal Interval</code> method for this classification. However, if you click <code>OK</code> and look at the resulting map you will notice that most block groups fall within the first group, the one that goes from 0 - 10.60 and that very few are fall in the other groups. In fact, it seems like there are a handful of block groups with more than 40 complaints (some of them in Queens), which are skewing the whole classification method upwards. An ideal classification method should instead display the full internal variation within the dataset.</p></li>
              <li><p>To change classification method go back to the properties and change the classification mode to <code>Natural Breaks (Jenks)</code> which deals better with datasets that are not normally distributed. You can find out more about this classification method <a href="https://en.wikipedia.org/wiki/Jenks_natural_breaks_optimization">here</a>.</p></li>
              <li><p>You can change your color ramp or the individual colors or strokes of each of the classes. You can also change the number of classes the data is divided into but note that normally, we can only really differentiate between 5 or 6 classes.</p></li>
            </ul>
            <img class="img-responsive" src="tutorialImages/04_PointData/10_Classification.png" alt="thumb">
            <ul>
              <li><p>Once you are done with the classification, click <code>OK</code> to apply it to the layer and see your results on the map.</p></li>
            </ul>
            <li><p>Once you are finished with this go ahead and adjust colors, strokes and layer order. And finally, create a print composer (below) where you can add a legend, title, explanation, source and a scale bar, and export your map as a PDF file. Your final map should look something like this:</p></li>
            <img class="img-responsive" src="tutorialImages/04_PointData/11_FinalMap.png" alt="thumb">
          </ul>
        </div>
        <div class="section">
          <span class="anchor" id="print"></span>
          <h1 class="page-header">Print Composer</h1>
          <p>The Print Composer is where you will format your map for its final output.
            Here you will specify the output size, you will add a legend, a scale bar, a north arrow (if needed) and any additional text
            (titles, sources, explanations and credits). Although the Print Composer exists as its own window it will still be linked to the map
            Project we have been working on.</p>
          <ul>
            <li><p>First, create a new Print Composer in <code>Project</code>, <code>New Print Composer</code>. Give it a custom name if you want,
            although this is not necessary.</p></li>
            <li><p>Once you are in the Print Composer you need to add a new map. Think of it as if you had a blank piece of paper and
            you were adding a window onto the map you've been working on. That window is a link to your Project and if you change things in the Project
            those changes will still be reflected in the Print Composer.</p></li>
            <li><p>To add a new map, click on the button <code>Add new map</code> on the left-hand panel and draw a rectangle on the blank page.</p></li>
            <img src="tutorialImages/01_BasicMap/08_AddNewMap.png" alt="thumb" class="img-responsive">
            <li><p>Once you add the map you can adjust its size and position by dragging it from its corners.</p></li>
            <li><p>You might notice that if you change the size of the map it doesn't necessarily update. To avoid this, on the right-hand panel, where it says
            <code>Main properties</code>, click on <code>Update preview</code>. Or, you can also click on the drop-down menu where it says
            <code>Cache</code> and change it to <code>Render</code> so that it is constantly updating. For this map, though, since we are working with pretty
            large layers (ie. PLUTO) leave it on the <code>Cache</code> option.</p></li>
            <img src="tutorialImages/01_BasicMap/09_UpdatePreview.png" alt="thumb" class="img-responsive">
            <li><p>To move the content inside the Print Composer (as opposed to the whole page) use the <code>Move item content</code> tool on the left-hand
            panel.</p></li>
            <img src="tutorialImages/01_BasicMap/10_MoveItemContent.png" alt="thumb" class="img-responsive">
            <li><p>Next, you need to center and zoom in the map on the area you want to focus on. For the purposes of this tutorial, we will
            include the 5 boroughs. To do this, move the content of the map to this area and on the right-hand panel, under <code>Main properties</code>,
            adjust your <code>Scale</code> to 230,000.</p></li>
            <li><p>If any of the colors or line weights seem too big or two small or not correct, you can always go back to the Project and change them there.
            When you return to your Print Composer you can update your preview and the changes will be reflected.</p></li>
            <li><p>Add a scale bar by going to <code>Layout</code> <code>Add scalebar</code> and clicking on the map.</p></li>
            <li><p>The default scale bar is too big and has some values left of the zero. To change this, go to the right-hand panel, in the top part make sure
            you select the <code>scale bar</code>, and in the Segments section change the <code>Segments</code> to 'left 0'.</p></li>
            <li><p>You can also adjust the <code>Height</code> of the scale bar to 2mm.</p></li>
            <li><p>Under Fonts and colors change the values to:</p></li>
            <ul>
              <li><p>Font color: #4d4d4d</p></li>
              <li><p>Fill color: #4d4d4d</p></li>
              <li><p>Stroke color: #4d4d4d</p></li>
            </ul>
            <li><p>Inside the <code>Font</code> menu you can choose a different font and/or a smaller size.</p></li>
            <li><p>To add a legend click on <code>Layout</code> <code>Add legend</code> and then click on the map. You will notice that QGIS automatically
            puts an icon for every layer in the map. We only need the ones for the Backup Sewer Complaints, so we need to customize the legend:</p></li>
            <ul>
              <li><p>On the right-hand panel, under Legend items uncheck <code>Auto update</code> and then select the layers that you don't want in the
              legend and remove them with the 'minus' button. Do the same thing inside the Backup Sewer Complaint layer and remove the categories you don't want to display (if any).</p></li>
              <li><p>Under <code>Main properties</code>, remove the 'Legend' in the <code>Title</code> field.</p></li>
              <li><p>Also, further down, uncheck the <code>Background</code> option.</p></li>
            </ul>
            <li><p>Since we did not rotate the map we don't need to add a north arrow. If you rotate your map you <b>must</b> add a north arrow. If you wanted
            to, you could add a north arrow by clicking on <code>Layout</code> <code>Add arrow</code>.</p></li>
            <li><p>Finally, to add a title and a 'source' text, click on the <code>Add new label</code> button on the left-hand panel and click on the map.
            Customize these labels by changing their color, size and location.</p></li>
            <li><p>The last step is to export the map as a .pdf file. Use the <code>Export as PDF</code> button on the top toolbar and save your map.</p></li>
          </ul>
        </div>
        <div class="section">
          <span class="anchor" id="note"></span>
          <h1 class="page-header">Note</h1>
          <p>If, after adding some dataset, you zoom in and some of the features disappear,
            you probably need to rebuild the dataset's "Spatial Index". To do this right-click on
            the layer, select <code>Properties</code> and go to <code>General</code>. Under
            <code>Coordinate reference system</code> click on <code>Create spatial index</code>.
            This should solve your problem. Sometimes, specially with the New York City PLUTO files,
            the "Spatial Index" is tied to one of the attribute fields and when you zoom in only
            the features with that specific attribute show up. "Spatial Index" are specially useful
            when doing operations over large datasets, for example see this <a href="https://nathanw.net/2013/01/04/using-a-qgis-spatial-index-to-speed-up-your-code/">post</a>.</p>
        </div>
      </div>
      <div class="col-md-3" role="complementary" id="myScrollspy">
        <nav class="sidebar hidden-print hidden-sm hidden-xs" data-spy="affix" data-offset-top="420">
          <ul class="nav sidenav">
            <li><a href="#datasets">Datasets</a></li>
            <li><a href="#about311data">About 311 Data</a></li>
            <li><a href="#download311">Accessing 311 Data</a></li>
            <li><a href="#addingLayers">Adding Layers</a></li>
            <li><a href="#symbology">Basic Symbology</a></li>
            <li><a href="#addingData">Adding Point Data to QGIS</a></li>
            <li><a href="#quantitative">Creating Quantitative Map</a></li>
            <li><a href="#print">Print Composer</a></li>

          </ul>
        </nav>
      </div>
    </div>
  </div>

  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="../js/bootstrap.min.js"></script>
</body>
</html>
